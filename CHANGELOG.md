# 更新日志

## [1.1.1] - 2025/11/19

- 功能变更：所有命令现在需要添加 `#` 前缀才能触发
  - `#今日运势` 或 `#jrys` 或 `#孑然一身` —— 获取今日运势
  - `#运势统计` 或 `#ystj` —— 查看个人统计信息
  - `#运势帮助` 或 `#ysbz` —— 查看帮助信息
  - `#运势数据` 或 `#yssj` —— 查询当前群聊今日签到情况
  - `#运势总数据` 或 `#yszsj` —— 查询总的今日签到情况
  - `#运势排行榜` 或 `#ysphb` —— 查看全局运势排行榜
- 新增功能：一言统计（`#一言统计` 或 `#yyts` - 查看备用一言库统计信息）

## [1.1.0]

- 新增功能：运势数据统计（#运势数据 yssj - 查询当前群聊今日签到情况）
- 新增功能：运势总数据统计（#运势总数据 yszsj - 查询总的今日签到情况）
- 新增功能：运势排行榜（运势排行榜 ysphb - 查看全局运势排行榜）
- 新增功能：备用一言库，自动保存成功获取的一言，API失败时使用备用库
- 性能优化：getAllUserData 和 getAllTodaySnapshots 改为并发读取，大幅提升性能
- 性能优化：配置文件添加缓存机制，避免重复解析JSON
- 代码重构：提取统一的日志记录函数 logMessage，减少重复代码
- 代码重构：提取获取用户昵称的公共方法 getUserName，提升代码复用性
- 修复问题：修复 fetch timeout 问题，使用 AbortController 实现正确的超时控制
- 修复问题：修复 generateFortuneImage 中动态导入问题，改为顶层导入
- 修复问题：修复 getAllTodayStats 统计历史数据的问题，现在只统计当日数据
- 算法优化：优化事件随机算法，确保宜忌事件不会重复，提升随机数生成质量

## [1.0.5]

- 修复等级显示问题，nextExp计算错误导致显示异常
- 将运势计算从均匀分布改为正态概率分布，更符合现实情况
- 整理JS文件，提取公共函数，减少代码重复

## [1.0.4]

- 修改每日签到经验加成上限
- 删除原来的黄历文件，转移到 Things.json 文件中
- 新增记录项 连续签到天数 连续签到即可获得每日 5% 的经验加成
- 新增用户签到检查，若两个月不签到则会被移动到 expired 文件夹内，再次签到则移除

## [1.0.3]

- 黄历内容扩充
- 快照清理，每天00:00
- 修复了运势、幸运值每天重复的BUG
- 将重复签到一言不刷新修改为刷新

---

## [1.0.0]

- 每日运势生成功能
- 等级系统实现
- 随机一言集成
- 搞怪黄历功能
- 时间问候功能
- 动态背景图片
- HTML模板渲染
- JSON配置文件支持
- 图片文件自动清理
